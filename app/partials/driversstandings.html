<body ng-app="stats" ng-controller="driversStandingsController">
    <!-- Navbar -->
    <div class="navbar-wrapper">
        <div class="container">
            <div class="navbar navbar-inverse navbar-static-top" role="navigation">
                <div class="container">
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                          <span class="sr-only">Toggle navigation</span>
                          <span class="icon-bar"></span>
                          <span class="icon-bar"></span>
                          <span class="icon-bar"></span>
                        </button>
                        <a class="navbar-brand" href="index.html">SportScience</a>
                    </div>
                    <div class="navbar-collapse collapse">
                        <ul class="nav navbar-nav">
                            <li><a href="#/drivers"><img src="img/icons/drivers.png" width="16" height="16" alt="Drivers">&nbsp;&nbsp;Drivers</a></li>
                            <li><a href="#/teams"><img src="img/icons/teams.png" width="16" height="16" alt="Teams">&nbsp;&nbsp;Teams</a></li>
                            <li><a href="#/races"><img src="img/icons/races.png" width="16" height="16" alt="Races">&nbsp;&nbsp;Races</a></li>
                            <li><a href="#/lap-chart"><img src="img/icons/stopwatch-16.png" width="16" height="16" alt="Races">&nbsp;&nbsp;Lap Chart</a></li>
                        </ul>
                        <ul class="nav navbar-nav navbar-right">
                            <li class="signin-margin"><a href="sign-in.html">Sign in</a></li>
                        </ul>
                        <form class="navbar-form navbar-right" role="search">
                            <div class="form-group">
                                <input type="text"  class="form-control" placeholder="Search" ng-model="nameFilter" >
                            </div>                    
                        </form>
                    </div>
                </div><!-- /.navbar-container -->
            </div><!-- /.navbar -->
        </div><!-- /.wrapper-container -->
    </div><!-- /.navbar-wrapper -->

    <!-- Content of the page -->
    <div class="container" style="padding-top: 90px">
        <div class="table-responsive">
          <table class="table table-striped table-bordered">
              <thead>
                  <tr><th colspan="4">Drivers Championship Standings - 2013</th></tr>
                  <tr>
                      <th>Position</th>
                      <th>Driver</th>
                      <th>Team</th>
                      <th>Points</th>
                  </tr>
              </thead>
              <tbody>
                  <tr ng-repeat="driver in driversList | filter: searchFilter">
                      <td style="vertical-align:middle">{{$index + 1}}.</td>
                      <td style="vertical-align:middle">
                          <a href="#/drivers/{{driver.Driver.driverId}}">
                              <img src="img/flags/flags/32/{{driver.Driver.nationality}}.png" style="margin-right: 8px">{{driver.Driver.givenName}}&nbsp;{{driver.Driver.familyName}}
                          </a>
                      </td> 
                      <td style="vertical-align:middle">{{driver.Constructors[0].name}}</td>
                      <td style="vertical-align:middle"> 
                          <span class="badge">{{driver.points}}</span>
                      </td>
                  </tr>
              </tbody>
          </table>

          
          <div id="chartdiv">
              

          </div>
          

        </div>
    </div>  
  
  
    <script type="text/javascript">

            $(function() {

            var chartData = []; 
            var colors = [
            "#FF0F00", "#FF6600", "#FF9E01", "#FCD202", "#F8FF01", "#B0DE09", "#04D215", "#0D8ECF", "#0D52D1",
            "#2A0CD0", "#8A0CCF", "#CD0D74", "#754DEB", "#DDDDDD", "#999999", "#333333", "#000000", "#0045D0",
            "#04E0D1", "#0560D0", "#000EFF", "#0FF0E0", "#F6DF00"
             ];
  
            var url = 'http://ergast.com/api/f1/2013/driverStandings.json?callback=JSON_CALLBACK';
            $.ajax({
            type: 'GET',
            url: url,
            async: false,
            jsonpCallback: 'jsonCallback',
            contentType: "application/json",
            dataType: 'jsonp',
            success: function(json) {
                var data = json.MRData.StandingsTable.StandingsLists[0].DriverStandings;
                for(var i = 0; i<data.length; i++){
                  var driver = {
                    driverName : data[i].Driver.givenName + " " + data[i].Driver.familyName,
                    points : data[i].points
                  };
                    chartData.push(driver);
                }

                for(var j=0; j<chartData.length; j++){
                  chartData[j].color = colors[j];
                }

                //graf
                var chart;
                // SERIAL CHART
                chart = new AmCharts.AmSerialChart();
                chart.dataProvider = chartData;
                chart.categoryField = "driverName";
                // the following two lines makes chart 3D
                chart.depth3D = 20;
                chart.angle = 30;

                // AXES
                // category
                var categoryAxis = chart.categoryAxis;
                categoryAxis.labelRotation = 70;
                categoryAxis.dashLength = 5;
                categoryAxis.gridPosition = "start";

                // value
                var valueAxis = new AmCharts.ValueAxis();
                valueAxis.title = "Points";
                valueAxis.dashLength = 5;
                chart.addValueAxis(valueAxis);

                // GRAPH
                var graph = new AmCharts.AmGraph();
                graph.valueField = "points";
                graph.colorField = "color";
                graph.balloonText = "<span style='font-size:14px'>[[category]]: <b>[[value]]</b></span>";
                graph.type = "column";
                graph.lineAlpha = 0;
                graph.fillAlphas = 1;
                chart.addGraph(graph);

                // CURSOR
                var chartCursor = new AmCharts.ChartCursor();
                chartCursor.cursorAlpha = 0;
                chartCursor.zoomable = false;
                chartCursor.categoryBalloonEnabled = false;
                chart.addChartCursor(chartCursor);

                chart.creditsPosition = "top-right";

                // WRITE
                chart.write("chartdiv");


            },
            error: function(e) {
           console.log(e.message);
    }
});

            
            });

        </script>

</body>